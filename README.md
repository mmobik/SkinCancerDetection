# Skin Cancer AI Detector

## Описание

Данный сервис использует нейронную сеть для анализа изображений родинок и прогнозирования вероятности наличия различных онкологических и неонкологических кожных заболеваний.

Пользователь загружает фотографию родинки, после чего модель возвращает три наиболее вероятных диагноза с указанием вероятности для каждого.

**Важно:** Этот сервис предоставляет только *предварительную* оценку риска и не является заменой медицинского диагноза. Перед любыми медицинскими действиями необходимо проконсультироваться с врачом. Модель обучалась на ограниченном наборе данных, поэтому возможны ошибки!

## Основные особенности:

*   Простой и удобный веб-интерфейс (благодаря Gradio).
*   Быстрая обработка изображений.
*   Топ-3 наиболее вероятных диагноза с указанием вероятности.
*   Использование передовых технологий глубокого обучения.

## Используемые технологии

*   **Python 3**
*   **PyTorch:** Основная библиотека для создания, обучения и развертывания нейронных сетей.
*   **Torchvision:** Библиотека, входящая в экосистему PyTorch, содержащая инструменты для работы с изображениями (преобразования, наборы данных).
*   **Gradio:** Библиотека для быстрого создания веб-интерфейсов для моделей машинного обучения.
*   **PIL (Pillow):** Библиотека для работы с изображениями.

## Классы заболеваний

| Код   | Заболевание                 |
| :---- | :-------------------------- |
| akiec | Актинический кератоз        |
| bcc   | Базальноклеточный рак       |
| bkl   | Доброкачественный кератоз   |
| df    | Дерматофиброма              |
| mel   | Меланома                    |
| nv    | Невус (родинка)             |
| vasc  | Сосудистое образование      |

## Как запустить проект

1.  **Клонировать репозиторий:**

    ```bash
    git clone https://github.com/mmobik/SkinCancerDetection.git
    cd SkinCancerDetection
    ```

2.  **Установить необходимые библиотеки:**

    ```bash
    pip install torch torchvision gradio pillow
    ```

3.  **Подготовить обученную модель:**

    *   Убедитесь, что у вас есть обученная модель в формате PyTorch `.pth`.
    *   Сохраните вашу обученную модель по пути: `saved_model/improved_hmnist.pth`
    *   **Важно:** Убедитесь, что архитектура модели совпадает с классом `ImprovedHMNIST_28x28` в коде.

4.  **Запустить сервис:**

    ```bash
    python main.py
    ```

    Интерфейс откроется в вашем браузере по адресу `http://localhost:7860` (или другому, указанному в консоли). Теперь вы можете загружать изображения и получать прогнозы.

## Структура проекта

Проект состоит из следующих основных директорий и файлов:

- `SkinCancerDetection/`: *Корневая директория проекта*
  - `ai/`: *Основная логика и запуск приложения*
    - `main.py`: *Точка входа в программу. Загружает модель, создает и запускает Gradio-интерфейс.*
  - `config.py`: *Конфигурационные параметры проекта*
    - `device`: Определяет, использовать ли GPU (CUDA) или CPU.
    - `BATCH_SIZE`, `LEARNING_RATE`, `EPOCHS`: Параметры обучения.
    - `CLASS_NAMES_FULL`: Словарь с полными названиями классов заболеваний.
    - `CLASS_NAMES`: Список сокращенных названий классов (используется для совместимости с моделью).
  - `dataset.py`: *Определение Dataset для подготовки изображений*
    - `HMNIST_28x28_PredictionDS`: Класс Dataset, который загружает изображения, изменяет их размер до 28x28, преобразует в тензоры и нормализует.
  - `interface.py`: *Создание Gradio интерфейса*
    - `create_gradio_interface`: Функция для создания интерфейса Gradio, позволяющего загружать изображения и отображать результаты.
  - `model.py`: *Определение архитектуры нейронной сети*
    - `ImprovedHMNIST_28x28`: Класс, определяющий архитектуру сверточной нейронной сети (CNN) для классификации изображений родинок.
  - `predict.py`: *Загрузка модели и предсказание класса изображения*
    - `load_model`: Функция для загрузки обученной модели из файла.
    - `predict_image`: Функция, принимающая путь к изображению и модель, и возвращающая топ-3 предсказания классов с вероятностями.
  - `saved_model/`: *Директория для хранения обученной модели*
    - `improved_hmnist.pth`: Файл с сохраненными весами обученной модели.
  - `test_ai.py`: *Прототип*.
  - `README.md`: *Этот файл, содержащий описание проекта*

